# üìù Proximity Service Technical Specification

## 1. Overview
A system that quickly searches for nearby businesses based on user location and provides detailed business information.

## 2. Refined Requirements

### Functional Requirements
- **Nearby Search**: Return a list of businesses given latitude/longitude and radius.
- **Business Management**: Retrieval, creation, update, deletion. (Write frequency is low).
- **Caching Strategy**: Cache business lists by Geohash grid and cache business detailed info.

### Non-Functional Requirements
- **Latency**: Target nearby search API response under 100ms.
- **Availability**: High read performance via Redis Cluster.
- **Scalability**: Horizontal scaling through stateless LBS servers.

## 3. API Design

### [GET] /api/search/nearby
- **Request Parameters**:
  - `lat`: Latitude (Decimal, -90.0 ~ 90.0)
  - `lon`: Longitude (Decimal, -180.0 ~ 180.0)
  - `radius`: Search radius (meters, range: 1 ~ 20,000, default: 5000)
- **Response**: Unified Response JSON
  ```json
  {
    "success": true,
    "data": [
      { "id": "uuid", "name": "Business A", "address": "...", "distance": 120.5, "distanceUnit": "METERS" }
    ],
    "error": null,
    "timestamp": "..."
  }
  ```

### [GET] /api/businesses/:id
- **Description**: Fetch business details by UUID.
- **Response**: Unified Response with `BusinessResponse` data.

## 4. Data Model Design

### Business Table (PostgreSQL)
- `business_id` (PK, UUID)
- `name` (String)
- `description` (Text)
- `address` (String)
- `latitude` (Decimal)
- `longitude` (Decimal)

### Geohash Index (Redis)
- Utilize Redis `GEOADD` and `GEOSEARCH`.
- Alternative: Geohash Prefix-based `Set` structure.

## 5. Implementation Roadmap

1.  **Step 1: Basic Project Setup** [COMPLETED]
2.  **Step 2: Data Mapping** [COMPLETED]
3.  **Step 3: Geohash Integration** [COMPLETED]
4.  **Step 4: Search Logic Implementation** [COMPLETED]
5.  **Step 5: Monitoring & Logging** [COMPLETED]
6.  **Step 6: Optimization & Scalability** [PLANNED]

---

## 6. Success Criteria
- Nearby 20 businesses are exposed within 100ms regardless of user location.
- Location data error is within 1m accuracy.
